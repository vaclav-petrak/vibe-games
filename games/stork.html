<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Čapí Hon - Hra pro 2</title>
    <style>
        body { margin: 0; overflow: hidden; background: #87CEEB; font-family: Arial, sans-serif; }
        canvas { display: block; background: linear-gradient(#87CEEB, #E0F6FF); }
        #ui { position: absolute; top: 10px; left: 20px; color: #2c3e50; font-weight: bold; font-size: 20px; pointer-events: none; }
    </style>
</head>
<body>
    <div id="ui">
        Hráč 1 (W/S): <span id="score1">0</span> | 
        Hráč 2 (↑/↓): <span id="score2">0</span>
    </div>
    <canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const score1El = document.getElementById('score1');
const score2El = document.getElementById('score2');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let score1 = 0;
let score2 = 0;
let gameOver = false;

const keys = {};
window.addEventListener('keydown', e => keys[e.code] = true);
window.addEventListener('keyup', e => keys[e.code] = false);

class Sprite {
    constructor(x, y, color, size, isPlayer = false) {
        this.x = x;
        this.y = y;
        this.color = color;
        this.size = size;
        this.speed = 5;
    }
    draw() {
        ctx.fillStyle = this.color;
        // Jednoduchý tvar čápa / objektu
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
        // Zobák pro čápy
        if (this.color === 'white') {
            ctx.fillStyle = 'orange';
            ctx.fillRect(this.x + this.size - 5, this.y - 2, 20, 4);
        }
    }
}

const player1 = new Sprite(100, canvas.height / 2, 'white', 25);
const player2 = new Sprite(200, canvas.height / 2, 'white', 25);
const enemies = []; // Holubi (šedí)
const foods = [];   // Žáby (zelené)

function spawnObjects() {
    if (Math.random() < 0.03) { // Holub
        enemies.push({ x: canvas.width, y: Math.random() * canvas.height, speed: 4 + Math.random() * 3 });
    }
    if (Math.random() < 0.02) { // Žába
        foods.push({ x: canvas.width, y: Math.random() * canvas.height, speed: 3 });
    }
}

function update() {
    if (gameOver) return;

    // Pohyb hráčů
    if (keys['KeyW'] && player1.y > 0) player1.y -= player1.speed;
    if (keys['KeyS'] && player1.y < canvas.height) player1.y += player1.speed;
    if (keys['ArrowUp'] && player2.y > 0) player2.y -= player2.speed;
    if (keys['ArrowDown'] && player2.y < canvas.height) player2.y += player2.speed;

    // Pohyb nepřátel (holubů)
    enemies.forEach((enemy, index) => {
        enemy.x -= enemy.speed;
        if (enemy.x < -50) enemies.splice(index, 1);

        // Kolize s holubem (konec hry nebo penalizace)
        [player1, player2].forEach((p, i) => {
            const dist = Math.hypot(p.x - enemy.x, p.y - enemy.y);
            if (dist < p.size + 15) {
                alert(`Hra skončila! Holub vás trefil. Skóre: P1: ${score1}, P2: ${score2}`);
                location.reload();
            }
        });
    });

    // Pohyb jídla (žab)
    foods.forEach((food, index) => {
        food.x -= food.speed;
        if (food.x < -50) foods.splice(index, 1);

        // Chytání žab
        if (Math.hypot(player1.x - food.x, player1.y - food.y) < player1.size + 15) {
            score1 += 10;
            score1El.innerText = score1;
            foods.splice(index, 1);
        } else if (Math.hypot(player2.x - food.x, player2.y - food.y) < player2.size + 15) {
            score2 += 10;
            score2El.innerText = score2;
            foods.splice(index, 1);
        }
    });

    spawnObjects();
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    player1.draw();
    player2.draw();

    // Vykreslení holubů
    ctx.fillStyle = '#7f8c8d';
    enemies.forEach(e => {
        ctx.beginPath();
        ctx.arc(e.x, e.y, 15, 0, Math.PI * 2);
        ctx.fill();
    });

    // Vykreslení žab
    ctx.fillStyle = '#2ecc71';
    foods.forEach(f => {
        ctx.beginPath();
        ctx.arc(f.x, f.y, 10, 0, Math.PI * 2);
        ctx.fill();
    });

    update();
    requestAnimationFrame(draw);
}

draw();
</script>
</body>
</html>